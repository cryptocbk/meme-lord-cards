<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Meme Lord Cards</title>
  <meta name="description" content="Turn any photo into a shareable Meme Lord card with AI‚Äëgenerated funny quotes. 100% client-side." />
  <meta name="theme-color" content="#0b0f16" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Bangers&display=swap" rel="stylesheet">
  <style>
    /* ... –æ—Å—Ç–∞–≤–∏–ª –≤–µ—Å—å CSS –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... */
  </style>
</head>
<body>
  <header>
    <div class="wrap nav">
      <div class="logo" style="font-family:Bangers,Inter,sans-serif;font-size:22px;display:flex;align-items:center;gap:10px">
        ü§ñ Meme Lord Cards
      </div>
      <span class="badge">100% client‚Äëside ‚Ä¢ free</span>
    </div>
  </header>

  <main class="wrap grid">
    <!-- LEFT: controls -->
    <section class="panel">
      <h2>1) Upload your photo</h2>
      <div id="drop" class="upload">
        <div>Drag & drop an image here or
          <label for="file" class="btn secondary">choose a file</label>
        </div>
        <div class="muted">JPG/PNG up to ~10 MB. Processed locally in your browser.</div>
        <input id="file" type="file" accept="image/*" />
      </div>

      <h2 style="margin-top:18px">2) Card settings</h2>
      <div class="row">
        <div class="field">
          <label>Display name</label>
          <input id="name" type="text" placeholder="Meme Lord" />
        </div>
        <div class="field">
          <label>Rarity</label>
          <select id="rarity">
            <option>Common</option>
            <option>Rare</option>
            <option>Epic</option>
            <option>Legendary</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Theme</label>
          <div class="chips" id="themes"></div>
        </div>
        <div class="field">
          <label>Funny quote</label>
          <div class="tools">
            <button id="quoteBtn" class="btn secondary" type="button">üé≠ Random</button>
            <button id="aiBtn" class="btn" type="button">‚ú® Generate with AI</button>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="field"><label>Meme Level</label><input id="lvl" type="number" min="0" max="999" value="87"/></div>
        <div class="field"><label>Virality %</label><input id="vir" type="number" min="0" max="100" value="69"/></div>
        <div class="field"><label>Chaos</label><input id="chs" type="number" min="0" max="100" value="42"/></div>
      </div>

      <div class="tools" style="margin-top:12px">
        <button id="randomBtn" class="btn" type="button">üé≤ Shuffle stats</button>
        <button id="genBtn" class="btn" type="button">‚ö° Render card</button>
        <button id="dlBtn" class="btn secondary" type="button">‚¨áÔ∏è Download PNG</button>
        <button id="shareBtn" class="btn ghost" type="button">üì§ Share</button>
      </div>

      <p class="muted" style="margin-top:10px">Privacy: your image never leaves your device. All rendering happens on the Canvas locally.</p>
    </section>

    <!-- RIGHT: preview -->
    <section class="panel">
      <h2>Preview</h2>
      <canvas id="card" width="750" height="1050" aria-label="Card preview"></canvas>
    </section>

    <section class="panel" style="grid-column:1/-1">
      <h2>Local gallery</h2>
      <div id="gallery" class="gallery"></div>
    </section>
  </main>

  <footer class="wrap">
    Built for fun ‚ù§Ô∏è ‚Äî host this single file on GitHub Pages. No trackers, no servers.
  </footer>

<script>
(function(){
  const $ = (s) => document.querySelector(s);
  const nameInput = $('#name');
  const rarity = $('#rarity');
  const lvl = $('#lvl');
  const vir = $('#vir');
  const chs = $('#chs');
  const card = $('#card');
  const ctx = card.getContext('2d');
  const dlBtn = $('#dlBtn');
  const genBtn = $('#genBtn');
  const randomBtn = $('#randomBtn');
  const quoteBtn = $('#quoteBtn');
  const aiBtn = $('#aiBtn');
  const shareBtn = $('#shareBtn');
  const gallery = $('#gallery');
  const themesWrap = $('#themes');
  const drop = $('#drop');
  const file = $('#file');

  // ---------- THEME DEFINITIONS ----------
  const THEMES = [
    { id:'neon', name:'Neon Vapor', bg:['#0f172a','#0b1220'], glow:'#22d3ee', primary:'#22d3ee', accent:'#f472b6'},
    { id:'gold', name:'Royal Gold', bg:['#1b1b1b','#101010'], glow:'#f59e0b', primary:'#fbbf24', accent:'#fde68a'},
    { id:'matrix', name:'Matrix', bg:['#00140a','#000d08'], glow:'#22c55e', primary:'#10b981', accent:'#34d399'},
    { id:'retro', name:'Retro Pop', bg:['#2b1b47','#1a1030'], glow:'#a78bfa', primary:'#f472b6', accent:'#fb7185'},
    { id:'steel', name:'Steel', bg:['#0a0a0a','#151515'], glow:'#60a5fa', primary:'#93c5fd', accent:'#e5e7eb'}
  ];

  // ---------- STATE ----------
  const state = {
    image: null,
    imageBitmap: null,
    quote: 'Certified Meme Lord',
    theme: THEMES[0]
  };

  // ---------- UI: THEME CHIPS ----------
  function renderThemeChips(){
    themesWrap.innerHTML = '';
    THEMES.forEach(t => {
      const chip = document.createElement('label');
      chip.className = 'theme-chip' + (state.theme.id===t.id ? ' active' : '');
      chip.innerHTML = `<input type="radio" name="theme" value="${t.id}"><span>üé® ${t.name}</span>`;
      chip.onclick = () => { state.theme = t; drawCard(); document.querySelectorAll('.theme-chip').forEach(c=>c.classList.remove('active')); chip.classList.add('active'); };
      themesWrap.appendChild(chip);
    });
  }
  renderThemeChips();

  // ---------- IMAGE HANDLING ----------
  function setDropActive(a){ drop.classList.toggle('drag', !!a); }
  ;['dragenter','dragover'].forEach(e=>drop.addEventListener(e, ev=>{ ev.preventDefault(); setDropActive(true); }));
  ;['dragleave','drop'].forEach(e=>drop.addEventListener(e, ev=>{ ev.preventDefault(); setDropActive(false); }));
  drop.addEventListener('drop', async (ev)=>{
    const f = ev.dataTransfer.files?.[0]; if(f) await loadFile(f);
  });
  file.addEventListener('change', async ()=>{ const f = file.files?.[0]; if(f) await loadFile(f); });

  async function loadFile(f){
    if(!f.type.startsWith('image/')) return alert('Please select an image file.');
    state.image = URL.createObjectURL(f);
    state.imageBitmap = await createImageBitmap(await (await fetch(state.image)).blob());
    drawCard();
  }

  // ---------- RANDOMIZATION ----------
  const FUNNY_LINES = [
    "Powered by caffeine and chaos",
    "Wi‚ÄëFi whisperer, router tamer",
    "Certified ‚Äòone more episode‚Äô pro",
    "Runs on memes and instant noodles",
    "404: serious face not found",
    "Keyboard warrior, snack mage",
    "Low battery, high drama",
    "Lag spikes, zero excuses",
    "Born to scroll, forced to work",
    "NPC energy, main‚Äëcharacter hair"
  ];
  function rand(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
  function randomize(){
    nameInput.value = ["Meme Lord","Chaos Gremlin","Vibe Captain","Emoji Overlord"][rand(0,3)];
    rarity.selectedIndex = rand(0,3);
    lvl.value = rand(10,999); vir.value = rand(1,100); chs.value = rand(0,100);
    state.quote = FUNNY_LINES[rand(0,FUNNY_LINES.length-1)];
    drawCard();
  }

  // ---------- AI QUOTE (DeepSeek —á–µ—Ä–µ–∑ Railway) ----------
  async function aiQuote(){
    const prompt = "Write a short, witty, meme-like one-liner for a social card. Max 12 words, internet humor, family-friendly.";
    aiBtn.disabled = true; aiBtn.textContent = '‚ú® Thinking...';
    try{
      const res = await fetch("https://–¢–í–û–ô_–ü–†–û–ï–ö–¢.up.railway.app/deepseek", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt })
      });
      const data = await res.json();
      const text = data.choices?.[0]?.message?.content?.trim();
      if(text) { state.quote = text; drawCard(); }
    }catch(err){
      console.error(err);
      alert("DeepSeek request failed.");
    }finally{
      aiBtn.disabled = false; aiBtn.textContent = '‚ú® Generate with AI';
    }
  }
  aiBtn.addEventListener('click', aiQuote);

  // ---------- DRAWING ----------
  /* ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∫–∞—Ä—Ç—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... */

  // ---------- EVENTS ----------
  randomBtn.addEventListener('click', randomize);
  quoteBtn.addEventListener('click', ()=>{ state.quote = FUNNY_LINES[rand(0,FUNNY_LINES.length-1)]; drawCard(); });
  genBtn.addEventListener('click', drawCard);

  // initial
  drawCard();
})();
</script>
</body>
</html>
